{"name":"profile","title":"InSpec Example Profile","maintainer":"Chef Software, Inc.","copyright":"Chef Software, Inc.","copyright_email":"support@chef.io","license":"Apache-2.0","summary":"Demonstrates the use of InSpec Compliance Profile","version":"1.0.0","supports":[{"platform-family":"unix"},{"platform-family":"windows"}],"controls":[{"title":"Create /tmp directory","desc":"An optional description...","descriptions":{"default":"An optional description...","label":"An optional description with a label"},"impact":0.7,"refs":[{"url":"http://...","ref":"Document A-12"}],"tags":{"data":"temp data","security":null},"code":"control \"tmp-1.0\" do                                   # A unique ID for this control\r\n  impact 0.7                                           # The criticality, if this control fails.\r\n  title \"Create /tmp directory\"                        # A human-readable title\r\n  desc \"An optional description...\"                    # Describe why this is needed\r\n  desc \"label\", \"An optional description with a label\" # Pair a part of the description with a label\r\n  tag data: \"temp data\"                                # A tag allows you to associate key information\r\n  tag \"security\"                                       # to the test\r\n  ref \"Document A-12\", url: 'http://...'               # Additional references\r\n\r\n  describe file('/tmp') do                             # The actual test\r\n    it { should be_directory }\r\n  end\r\nend\r\n","source_location":{"ref":"tst/examples/profile/controls/example.rb","line":6},"id":"tmp-1.0"},{"title":null,"desc":null,"descriptions":{},"impact":0.5,"refs":[],"tags":{},"code":"","source_location":{"ref":"/opt/chefdk/embedded/lib/ruby/gems/2.6.0/gems/inspec-4.3.2/lib/inspec/control_eval_context.rb","line":136},"id":"(generated from example.rb:21 d0c333289391dc803a86361aa9899dc6)"},{"title":"Verify the version number of Gordon","desc":"An optional description...","descriptions":{"default":"An optional description..."},"impact":0.9,"refs":[{"uri":"http://...","ref":"Gordon Requirements 1.0"}],"tags":{"gordon":null},"code":"control 'gordon-1.0' do\r\n  impact 'critical'\r\n  title 'Verify the version number of Gordon'\r\n  desc 'An optional description...'\r\n  tag 'gordon'\r\n  ref 'Gordon Requirements 1.0', uri: 'http://...'\r\n\r\n  # Test using the custom gordon_config InSpec resource\r\n  # Find the resource content here: ../libraries/\r\n  describe gordon_config do\r\n    it { should exist }\r\n    its('version') { should eq('1.0') }\r\n    its('file_size') { should <= 20 }\r\n    its('comma_count') { should eq 0 }\r\n  end\r\n\r\n  # Test the version again to showcase variables\r\n  g = gordon_config\r\n  g_path = g.file_path\r\n  g_version = g.version\r\n  describe file(g_path) do\r\n    its('content') { should match g_version }\r\n  end\r\nend\r\n","source_location":{"ref":"tst/examples/profile/controls/gordon.rb","line":12},"id":"gordon-1.0"},{"title":"Allow only SSH Protocol 2","desc":"Only SSH protocol version 2 connections should be permitted.\n        The default setting in /etc/ssh/sshd_config is correct, and can be\n        verified by ensuring that the following line appears: Protocol 2","descriptions":{"default":"Only SSH protocol version 2 connections should be permitted.\n        The default setting in /etc/ssh/sshd_config is correct, and can be\n        verified by ensuring that the following line appears: Protocol 2"},"impact":1.0,"refs":[{"url":"https://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf","ref":"NSA-RH6-STIG - Section 3.5.2.1"},{"url":"http://iasecontent.disa.mil/stigs/zip/Jan2016/U_RedHat_6_V1R10_STIG.zip","ref":"DISA-RHEL6-SG - Section 9.2.1"},{"ref":"http://people.redhat.com/swells/scap-security-guide/RHEL/6/output/ssg-centos6-guide-C2S.html"}],"tags":{"production":null,"development":null,"ssh":null,"sshd":null,"openssh-server":null,"cce":"CCE-27072-8","disa":"RHEL-06-000227","nist":"IA-5(1)","cci":"CCI-001436","remediation":"https://supermarket.chef.io/cookbooks/ssh-hardening"},"code":"control 'ssh-1' do\r\n  impact 1.0\r\n\r\n  title 'Allow only SSH Protocol 2'\r\n  desc 'Only SSH protocol version 2 connections should be permitted.\r\n        The default setting in /etc/ssh/sshd_config is correct, and can be\r\n        verified by ensuring that the following line appears: Protocol 2'\r\n\r\n  tag 'production','development'\r\n  tag 'ssh','sshd','openssh-server'\r\n\r\n  tag cce: 'CCE-27072-8'\r\n  tag disa: 'RHEL-06-000227'\r\n\r\n  tag nist: 'AC-3(10).i'\r\n  tag nist: 'IA-5(1)'\r\n\r\n  tag cci: 'CCI-000776'\r\n  tag cci: 'CCI-000774'\r\n  tag cci: 'CCI-001436'\r\n\r\n  tag remediation: 'stig_rhel6/recipes/sshd-config.rb'\r\n  tag remediation: 'https://supermarket.chef.io/cookbooks/ssh-hardening'\r\n\r\n  ref 'NSA-RH6-STIG - Section 3.5.2.1', url: 'https://www.nsa.gov/ia/_files/os/redhat/rhel5-guide-i731.pdf'\r\n  ref 'DISA-RHEL6-SG - Section 9.2.1', url: 'http://iasecontent.disa.mil/stigs/zip/Jan2016/U_RedHat_6_V1R10_STIG.zip'\r\n  ref 'http://people.redhat.com/swells/scap-security-guide/RHEL/6/output/ssg-centos6-guide-C2S.html'\r\n\r\n  only_if { platform.in_family?('unix') }\r\n\r\n  describe file('/bin/sh') do\r\n    it { should be_owned_by 'root' }\r\n  end\r\nend\r\n","source_location":{"ref":"tst/examples/profile/controls/meta.rb","line":3},"id":"ssh-1"}],"groups":[{"title":"/tmp profile","controls":["tmp-1.0","(generated from example.rb:21 d0c333289391dc803a86361aa9899dc6)"],"id":"controls/example.rb"},{"title":"Gordon Config Checks","controls":["gordon-1.0"],"id":"controls/gordon.rb"},{"title":"SSH Server Configuration","controls":["ssh-1"],"id":"controls/meta.rb"}],"inputs":[],"sha256":"3e0a322c8d2956a36013937fdc78573fb480a8d4c073cbc7447dc775e72663e9","status":"loaded","generator":{"name":"inspec","version":"4.3.2"}}
