{"version":"1.37.6","controls":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.004127,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000116,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.002735,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.035472,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000175,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000143,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031912,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000257,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.5e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.033312,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000149,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000214,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.032797,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000176,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000178,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000123,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.0001,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000138,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.1e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000206,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000205,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000179,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.00013,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000114,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000104,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000125,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":8.9e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000109,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000197,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000229,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000177,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000127,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000148,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000249,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000119,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000127,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000188,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.9e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.003341,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.00538,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000145,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000112,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.00018,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000168,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000106,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000166,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000147,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000112,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000172,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000114,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000163,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000129,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000215,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000105,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.00018,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000166,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.0001,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000199,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000102,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"failed","code_desc":"Mount /var/log/audit should be mounted","run_time":0.045423,"start_time":"2017-09-19 23:27:20 -0400","message":"\nMount /var/log/audit is not mounted\n"},{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":1.0e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000157,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000153,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":8.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.030804,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000241,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.043941,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000186,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000155,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000206,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000131,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000191,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000261,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.00022,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000195,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000258,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000117,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch owner should eq \"elasticsearch\"","run_time":0.12445,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch group should eq \"elasticsearch\"","run_time":0.000326,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"elastic should be in \"elastic\"","run_time":0.000319,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000131,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000207,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000251,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000151,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000184,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000119,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.00015,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000178,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00016,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000133,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.030099,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000161,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000198,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.037622,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000102,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.034002,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000243,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000159,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000104,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.051369,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00013,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.050804,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000155,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000131,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.041751,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000162,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.046599,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.00025,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000144,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000115,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.093352,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000302,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000164,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00014,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000128,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.041689,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000263,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000176,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000107,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000136,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000223,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000246,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000146,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.0426,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000231,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000203,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000202,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000123,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.036733,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000146,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000209,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000122,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036179,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000245,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000113,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000168,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.042918,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.4e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00012,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031388,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000161,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000166,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.9e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031052,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000156,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.4e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000119,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031996,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000202,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00011,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.00011,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031432,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.00018,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000185,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":9.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":8.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.0e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.028621,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000227,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000131,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.03117,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000159,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.9e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000182,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.8e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.109469,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000167,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000138,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000182,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000133,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.057575,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000168,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.00019,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.053144,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000214,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000225,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000125,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000116,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.048795,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000106,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000326,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000239,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036923,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000152,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00015,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.0001,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.044417,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000247,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000113,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000132,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000187,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000106,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.075188,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000179,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000189,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000221,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000185,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.042216,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.0003,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000205,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000117,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000128,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00011,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036443,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000135,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000101,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000105,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.068814,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000124,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.091196,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000158,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.081827,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"failed","code_desc":"Command aide should exist","run_time":0.057924,"start_time":"2017-09-19 23:27:22 -0400","message":"expected Command aide to exist"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000175,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.05576,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.00023,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.0002,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000199,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000166,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.033862,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":1.3e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000217,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.9e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000338,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.00019,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031309,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000214,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000201,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000154,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000204,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.035731,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000123,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000158,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.032748,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000152,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000311,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000114,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.036113,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000344,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000131,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000142,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.139245,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000174,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000127,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000113,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000118,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.053855,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.0002,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000148,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000305,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000133,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.033781,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000126,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.03787,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"failed","code_desc":"File /var/log/audit mode should cmp <= 420","run_time":0.035049,"start_time":"2017-09-19 23:27:22 -0400","message":"\nexpected it to be <= 420\n     got: 488\n\n(compared using `cmp` matcher)\n"},{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml owner should eq \"elasticsearch\"","run_time":0.000283,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml group should eq \"elasticsearch\"","run_time":0.000136,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml mode should cmp <= 416","run_time":0.000274,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":6.0e-06,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000124,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.0e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.043375,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000239,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000136,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.0001,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000109,"start_time":"2017-09-19 23:27:23 -0400"}],"other_checks":[],"profiles":[{"name":"elasticsearch-baseline","title":"Elasticsearch Baseline","maintainer":"The Authors","copyright":"The Authors","copyright_email":"you@example.com","license":"Apache-2.0","summary":"An InSpec Compliance Profile","version":"0.1.0","supports":[],"controls":[{"title":"Use human readable security markings","desc":"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.","impact":0.5,"refs":[],"tags":{"nist":["AC-16 (5)","Rev_4"],"severity":"medium","rid":"SV-33879r1_rule","stig_id":"SRG-APP-000013","cci":"CCI-001428","check":"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. ","fix":"This requirement is a permanent not a finding. No fix is\nrequired."},"code":"control \"V-26680\" do\n  title \"Use human readable security markings\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16 (5)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33879r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000013\"\n  tag \"cci\": \"CCI-001428\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26680.rb","line":1},"id":"V-26680"},{"title":"Encrypt information in transit both at the application and\nElasticsearch perimeter and within the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (2)","Rev_4"],"severity":"medium","rid":"SV-33881r1_rule","stig_id":"SRG-APP-000014","cci":"CCI-000068","check":"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26681\" do\n  title \"Encrypt information in transit both at the application and\nElasticsearch perimeter and within the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33881r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000014\"\n  tag \"cci\": \"CCI-000068\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26681.rb","line":21},"id":"V-26681","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.004127,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000116,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.002735,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.035472,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000175,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000143,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031912,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (2)","Rev_4"],"severity":"medium","rid":"SV-33882r1_rule","stig_id":"SRG-APP-000015","cci":"CCI-001453","check":"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26682\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33882r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000015\"\n  tag \"cci\": \"CCI-001453\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26682.rb","line":21},"id":"V-26682","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000257,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.5e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.033312,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000149,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000214,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.032797,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Centralize audit records from Elasticsearch to a system capable of\ntaking actions to control remote access sessions","desc":"Collect Elasticsearch X-Pack Security audit records from all\nElasticsearch nodes in near-real time to enable audit monitoring.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (1)","Rev_4"],"severity":"medium","rid":"SV-33904r1_rule","stig_id":"SRG-APP-000016","cci":"CCI-000067","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26684\" do\n  title \"Centralize audit records from Elasticsearch to a system capable of\ntaking actions to control remote access sessions\"\n  desc  \"Collect Elasticsearch X-Pack Security audit records from all\nElasticsearch nodes in near-real time to enable audit monitoring.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33904r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000016\"\n  tag \"cci\": \"CCI-000067\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26684.rb","line":1},"id":"V-26684"},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (3)","Rev_4"],"severity":"medium","rid":"SV-33908r1_rule","stig_id":"SRG-APP-000017","cci":"CCI-000069","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26685\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33908r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000017\"\n  tag \"cci\": \"CCI-000069\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26685.rb","line":40},"id":"V-26685","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000176,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000178,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000123,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.0001,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (7)","Rev_3"],"severity":"medium","rid":"SV-33910r1_rule","stig_id":"SRG-APP-000019","cci":"CCI-001454","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n\"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26687\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (7)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33910r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000019\"\n  tag \"cci\": \"CCI-001454\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n\\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26687.rb","line":39},"id":"V-26687","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000138,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.1e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000206,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Control access points to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AC-17 (8)","Rev_3"],"severity":"medium","rid":"SV-33911r1_rule","stig_id":"SRG-APP-000020","cci":"CCI-001436","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n\"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26688\" do\n  title \"Control access points to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (8)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33911r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000020\"\n  tag \"cci\": \"CCI-001436\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n\\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26688.rb","line":39},"id":"V-26688","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000205,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000171,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000179,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (1)","Rev_4"],"severity":"medium","rid":"SV-33942r1_rule","stig_id":"SRG-APP-000023","cci":"CCI-000015","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26699\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33942r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000023\"\n  tag \"cci\": \"CCI-000015\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26699.rb","line":1},"id":"V-26699"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (2)","Rev_4"],"severity":"medium","rid":"SV-33944r1_rule","stig_id":"SRG-APP-000024","cci":"CCI-000016","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26701\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33944r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000024\"\n  tag \"cci\": \"CCI-000016\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26701.rb","line":1},"id":"V-26701"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (4)","Rev_4"],"severity":"medium","rid":"SV-33948r1_rule","stig_id":"SRG-APP-000026","cci":"CCI-000018","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26705\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33948r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000026\"\n  tag \"cci\": \"CCI-000018\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26705.rb","line":1},"id":"V-26705"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (4)","Rev_4"],"severity":"medium","rid":"SV-33978r1_rule","stig_id":"SRG-APP-000028","cci":"CCI-001404","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish account disabling.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26730\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33978r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000028\"\n  tag \"cci\": \"CCI-001404\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish account disabling.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26730.rb","line":1},"id":"V-26730"},{"title":null,"desc":null,"impact":0.5,"refs":[],"tags":{"nist":["AC-3 (2)","Rev_4"],"severity":"medium","rid":"SV-33985r1_rule","stig_id":"SRG-APP-000034","cci":"CCI-000021","check":"The only dual factor that elasticsearch PKI, ","fix":"None"},"code":"control \"V-26737\" do\n  impact 0.5\n  tag \"nist\": [\"AC-3 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33985r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000034\"\n  tag \"cci\": \"CCI-000021\"\n  tag \"check\": \"The only dual factor that elasticsearch PKI, \"\n  tag \"fix\": \"None\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26737.rb","line":1},"id":"V-26737"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-3 (3) (a)","Rev_3"],"severity":"medium","rid":"SV-33996r1_rule","stig_id":"SRG-APP-000035","cci":"CCI-000022","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26748\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (3) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33996r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000035\"\n  tag \"cci\": \"CCI-000022\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26748.rb","line":1},"id":"V-26748"},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["AC-4 (17) (a)","Rev_3"],"severity":"medium","rid":"SV-34025r1_rule","stig_id":"SRG-APP-000049","cci":"CCI-001376","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application/json    -XGET\n\"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26775\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34025r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000049\"\n  tag \"cci\": \"CCI-001376\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application/json    -XGET\n\\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26775.rb","line":39},"id":"V-26775","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.00013,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000114,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000104,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["AC-4 (17) (a)","Rev_3"],"severity":"medium","rid":"SV-34026r1_rule","stig_id":"SRG-APP-000050","cci":"CCI-001377","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26776\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34026r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000050\"\n  tag \"cci\": \"CCI-001377\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26776.rb","line":39},"id":"V-26776","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000125,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":8.9e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000109,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["AC-4 (17) (a)","Rev_3"],"severity":"medium","rid":"SV-34027r1_rule","stig_id":"SRG-APP-000051","cci":"CCI-001555","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26777\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34027r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000051\"\n  tag \"cci\": \"CCI-001555\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26777.rb","line":39},"id":"V-26777","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000197,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000229,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000177,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000127,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["AC-4 (2)","Rev_4"],"severity":"medium","rid":"SV-34036r1_rule","stig_id":"SRG-APP-000054","cci":"CCI-000026","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26786\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34036r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000054\"\n  tag \"cci\": \"CCI-000026\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26786.rb","line":39},"id":"V-26786","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000148,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000249,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000119,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000127,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["AC-4 (4)","Rev_4"],"severity":"medium","rid":"SV-34040r1_rule","stig_id":"SRG-APP-000056","cci":"CCI-000028","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-26790\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34040r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000056\"\n  tag \"cci\": \"CCI-000028\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26790.rb","line":39},"id":"V-26790","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000188,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":9.9e-05,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34125r1_rule","stig_id":"SRG-APP-000095","cci":"CCI-000130","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.enabled\nit is not set to true it is a finding\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26845\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34125r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000095\"\n  tag \"cci\": \"CCI-000130\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.enabled\nit is not set to true it is a finding\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26845.rb","line":24},"id":"V-26845","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.003341,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.00538,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000145,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34127r1_rule","stig_id":"SRG-APP-000096","cci":"CCI-000131","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26847\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34127r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000096\"\n  tag \"cci\": \"CCI-000131\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\n  \nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26847.rb","line":24},"id":"V-26847","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000112,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.00018,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000168,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34129r1_rule","stig_id":"SRG-APP-000097","cci":"CCI-000132","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26849\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34129r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000097\"\n  tag \"cci\": \"CCI-000132\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26849.rb","line":24},"id":"V-26849","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000106,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000166,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000147,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34131r1_rule","stig_id":"SRG-APP-000098","cci":"CCI-000133","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26851\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34131r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000098\"\n  tag \"cci\": \"CCI-000133\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26851.rb","line":24},"id":"V-26851","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000112,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000172,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000114,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-7 a","Rev_4"],"severity":"medium","rid":"SV-34133r1_rule","stig_id":"SRG-APP-000065","cci":"CCI-000044","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26853\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34133r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000065\"\n  tag \"cci\": \"CCI-000044\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26853.rb","line":1},"id":"V-26853"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-7 a","Rev_3"],"severity":"medium","rid":"SV-34135r1_rule","stig_id":"SRG-APP-000066","cci":"CCI-001452","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26855\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 a\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34135r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000066\"\n  tag \"cci\": \"CCI-001452\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26855.rb","line":1},"id":"V-26855"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-7 b","Rev_3"],"severity":"medium","rid":"SV-34136r1_rule","stig_id":"SRG-APP-000067","cci":"CCI-000047","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26856\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 b\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34136r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000067\"\n  tag \"cci\": \"CCI-000047\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26856.rb","line":1},"id":"V-26856"},{"title":"Approved System Use notification","desc":"Create a HA proxy static page that shows System Usage notification","impact":0.5,"refs":[],"tags":{"nist":["AC-8 a","Rev_4"],"severity":"medium","rid":"SV-34138r1_rule","stig_id":"SRG-APP-000068","cci":"CCI-000048","check":"Possible not applicable because of server to service\ncommuncation, when user login vai LDAP/AD you may show banner in Kibana.\nDependant on user service, When using kibana - set this prooperty.  For\nelasticsearch during service connection ","fix":"None"},"code":"control \"V-26858\" do\n  title \"Approved System Use notification\"\n  desc  \"Create a HA proxy static page that shows System Usage notification\"\n  impact 0.5\n  tag \"nist\": [\"AC-8 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34138r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000068\"\n  tag \"cci\": \"CCI-000048\"\n  tag \"check\": \"Possible not applicable because of server to service\ncommuncation, when user login vai LDAP/AD you may show banner in Kibana.\nDependant on user service, When using kibana - set this prooperty.  For\nelasticsearch during service connection \"\n  tag \"fix\": \"None\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26858.rb","line":1},"id":"V-26858"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34140r1_rule","stig_id":"SRG-APP-000099","cci":"CCI-000134","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26860\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34140r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000099\"\n  tag \"cci\": \"CCI-000134\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26860.rb","line":24},"id":"V-26860","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000163,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000129,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000215,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000105,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3","Rev_4"],"severity":"medium","rid":"SV-34144r1_rule","stig_id":"SRG-APP-000100","cci":"CCI-001487","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the user/subject associated with an event.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26864\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34144r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000100\"\n  tag \"cci\": \"CCI-001487\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the user/subject associated with an event.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26864.rb","line":24},"id":"V-26864","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.00018,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000103,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000166,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-3 (1)","Rev_4"],"severity":"medium","rid":"SV-34148r1_rule","stig_id":"SRG-APP-000101","cci":"CCI-000135","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26868\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34148r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000101\"\n  tag \"cci\": \"CCI-000135\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26868.rb","line":24},"id":"V-26868","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.0001,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000199,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000102,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-9 (1)","Rev_4"],"severity":"medium","rid":"SV-34161r1_rule","stig_id":"SRG-APP-000076","cci":"CCI-000053","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26881\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34161r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000076\"\n  tag \"cci\": \"CCI-000053\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26881.rb","line":1},"id":"V-26881"},{"title":"Allocate storage space for Audit records","desc":"Provision adequate storage for audit records in an automated fashion\nbased upon capacity studies for production systems.","impact":0.5,"refs":[],"tags":{"nist":["AU-4","Rev_3"],"severity":"medium","rid":"SV-34162r1_rule","stig_id":"SRG-APP-000072","cci":"CCI-000137","check":"Run the following command to determine if /var/log/audit is on\nits own partition or logical volume:\n$ mount | grep \"on /var/log/audit \"\nIf /var/log/audit has its own partition or volume group, a line will be\nreturned. If no line is returned, this is a finding.","fix":"Audit logs are stored in the /var/log/audit directory. Ensure\nthat it has its own partition or logical volume at installation time, or\nmigrate it later using LVM. Make absolutely certain that it is large enough to\nstore all audit logs that will be created by the auditing daemon."},"code":"control \"V-26882\" do\n  title \"Allocate storage space for Audit records\"\n  desc  \"Provision adequate storage for audit records in an automated fashion\nbased upon capacity studies for production systems.\"\n  impact 0.5\n  tag \"nist\": [\"AU-4\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34162r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000072\"\n  tag \"cci\": \"CCI-000137\"\n  tag \"check\": \"Run the following command to determine if /var/log/audit is on\nits own partition or logical volume:\n$ mount | grep \\\"on /var/log/audit \\\"\nIf /var/log/audit has its own partition or volume group, a line will be\nreturned. If no line is returned, this is a finding.\"\n  tag \"fix\": \"Audit logs are stored in the /var/log/audit directory. Ensure\nthat it has its own partition or logical volume at installation time, or\nmigrate it later using LVM. Make absolutely certain that it is large enough to\nstore all audit logs that will be created by the auditing daemon.\"\n\n  begin\n    describe mount('/var/log/audit') do\n      it { should be_mounted }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26882.rb","line":7},"id":"V-26882","results":[{"status":"failed","code_desc":"Mount /var/log/audit should be mounted","run_time":0.045423,"start_time":"2017-09-19 23:27:20 -0400","message":"\nMount /var/log/audit is not mounted\n"}]},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-9 (2)","Rev_4"],"severity":"medium","rid":"SV-34163r1_rule","stig_id":"SRG-APP-000077","cci":"CCI-001391","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26883\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34163r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000077\"\n  tag \"cci\": \"CCI-001391\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26883.rb","line":1},"id":"V-26883"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-9 (2)","Rev_4"],"severity":"medium","rid":"SV-34164r1_rule","stig_id":"SRG-APP-000078","cci":"CCI-001392","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26884\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34164r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000078\"\n  tag \"cci\": \"CCI-001392\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26884.rb","line":1},"id":"V-26884"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-9 (3)","Rev_4"],"severity":"medium","rid":"SV-34166r1_rule","stig_id":"SRG-APP-000079","cci":"CCI-001395","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26886\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34166r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000079\"\n  tag \"cci\": \"CCI-001395\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26886.rb","line":1},"id":"V-26886"},{"title":"Move Audit records off Elasticsearch boxes / Setup watcher/alerting on\nsecondary system","desc":"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.","impact":0.5,"refs":[],"tags":{"nist":["AU-5 (2)","Rev_3"],"severity":"medium","rid":"SV-34172r1_rule","stig_id":"SRG-APP-000104","cci":"CCI-000144","check":"The necessary monitoring and alerts may be implemented using\nfeatures of elasticsearch, the OS, third-party software, custom code, or a\ncombination of these. The term \"the system\" is used to encompass all of\nthese.\n\nReview the system documentation to determine which audit failure events require\nreal-time alerts. Review the system settings and code.\n\nIf the real-time alerting that is specified in the documentation is not\nenabled, this is a finding.","fix":"Configure the system to provide an immediate real-time alert to\nappropriate support staff when a specified audit failure occurs.\n\nIt is possible to create scripts or implement third-party tools to enable\nreal-time alerting for audit failures in elasticsearch."},"code":"control \"V-26892\" do\n  title \"Move Audit records off Elasticsearch boxes / Setup watcher/alerting on\nsecondary system\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34172r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000104\"\n  tag \"cci\": \"CCI-000144\"\n  tag \"check\": \"The necessary monitoring and alerts may be implemented using\nfeatures of elasticsearch, the OS, third-party software, custom code, or a\ncombination of these. The term \\\"the system\\\" is used to encompass all of\nthese.\n\nReview the system documentation to determine which audit failure events require\nreal-time alerts. Review the system settings and code.\n\nIf the real-time alerting that is specified in the documentation is not\nenabled, this is a finding.\"\n  tag \"fix\": \"Configure the system to provide an immediate real-time alert to\nappropriate support staff when a specified audit failure occurs.\n\nIt is possible to create scripts or implement third-party tools to enable\nreal-time alerting for audit failures in elasticsearch.\"\n\n  only_if do\n    false\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26892.rb","line":1},"id":"V-26892","results":[{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":1.0e-05,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":null,"desc":null,"impact":0.5,"refs":[],"tags":{"nist":["AU-10 (4) (a)","Rev_4"],"severity":"medium","rid":"SV-34174r1_rule","stig_id":"SRG-APP-000084","cci":"CCI-001341","check":"Application must utilize protective mechanisms when\nrecieving/transfering from one security domain to another.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures against unauthorized disclosure and\nmodification prior to transfer/release of data between security domains.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26894\" do\n  impact 0.5\n  tag \"nist\": [\"AU-10 (4) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34174r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000084\"\n  tag \"cci\": \"CCI-001341\"\n  tag \"check\": \"Application must utilize protective mechanisms when\nrecieving/transfering from one security domain to another.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures against unauthorized disclosure and\nmodification prior to transfer/release of data between security domains.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26894.rb","line":21},"id":"V-26894","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000157,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000153,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":8.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.030804,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000241,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.043941,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-12 (1)","Rev_4"],"severity":"medium","rid":"SV-34176r1_rule","stig_id":"SRG-APP-000086","cci":"CCI-000174","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26896\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34176r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000086\"\n  tag \"cci\": \"CCI-000174\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26896.rb","line":24},"id":"V-26896","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000186,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000155,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000206,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-12 (2)","Rev_4"],"severity":"medium","rid":"SV-34180r1_rule","stig_id":"SRG-APP-000088","cci":"CCI-001353","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26900\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34180r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000088\"\n  tag \"cci\": \"CCI-001353\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26900.rb","line":24},"id":"V-26900","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000118,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000131,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000191,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000261,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-12 b","Rev_4"],"severity":"medium","rid":"SV-34182r1_rule","stig_id":"SRG-APP-000090","cci":"CCI-000171","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26902\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34182r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000090\"\n  tag \"cci\": \"CCI-000171\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe file(ES_HOME) do\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    cmd = \"curl -XGET  -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_xpack/security/user -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    userlist = json(command:cmd).params\n\n    userlist.keys.each do |user|\n      if userlist[user]['roles'].include?('superuser')\n        describe userlist[user]['username'] do\n          it { should be_in ES_SUPERUSERS}\n        end\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26902.rb","line":72},"id":"V-26902","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.00022,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000195,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000258,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000117,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch owner should eq \"elasticsearch\"","run_time":0.12445,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch group should eq \"elasticsearch\"","run_time":0.000326,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"elastic should be in \"elastic\"","run_time":0.000319,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-12 c","Rev_4"],"severity":"medium","rid":"SV-34183r1_rule","stig_id":"SRG-APP-000091","cci":"CCI-000172","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26903\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34183r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000091\"\n  tag \"cci\": \"CCI-000172\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\n\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26903.rb","line":24},"id":"V-26903","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000131,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000207,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000251,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000151,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-14 (1)","Rev_4"],"severity":"medium","rid":"SV-34184r1_rule","stig_id":"SRG-APP-000092","cci":"CCI-001464","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26904\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-14 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34184r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000092\"\n  tag \"cci\": \"CCI-001464\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26904.rb","line":24},"id":"V-26904","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.000108,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000128,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000184,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000119,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Enable secured communication to and within the Elasticsearch cluster","desc":"Configure PKI authentication, TLS/SSL, and cluster key features of\nX-pack Security so that authentication and communication within Elasticsearch\nis replay resistant.","impact":0.5,"refs":[],"tags":{"nist":["IA-2 (8)","Rev_3"],"severity":"medium","rid":"SV-34187r1_rule","stig_id":"SRG-APP-000156","cci":"CCI-000774","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26907\" do\n  title \"Enable secured communication to and within the Elasticsearch cluster\"\n  desc  \"Configure PKI authentication, TLS/SSL, and cluster key features of\nX-pack Security so that authentication and communication within Elasticsearch\nis replay resistant.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (8)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34187r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000156\"\n  tag \"cci\": \"CCI-000774\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26907.rb","line":39},"id":"V-26907","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.00015,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000178,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Enable secured communication to and within the Elasticsearch cluster","desc":"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is replay resistant.","impact":0.5,"refs":[],"tags":{"nist":["IA-2 (9)","Rev_3"],"severity":"medium","rid":"SV-34188r1_rule","stig_id":"SRG-APP-000157","cci":"CCI-000776","check":"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26908\" do\n  title \"Enable secured communication to and within the Elasticsearch cluster\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is replay resistant.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (9)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34188r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000157\"\n  tag \"cci\": \"CCI-000776\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26908.rb","line":21},"id":"V-26908","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.3e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00016,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000133,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.030099,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000161,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000198,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.6e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.037622,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["IA-3 (1)","Rev_3"],"severity":"medium","rid":"SV-34190r1_rule","stig_id":"SRG-APP-000159","cci":"CCI-000779","check":"Application must utilize bidirectional authentication for\ncryptographic device communication.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement bidirectional (client-server handshake) for\nestablishing cryptographic communication.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26910\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"IA-3 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34190r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000159\"\n  tag \"cci\": \"CCI-000779\"\n  tag \"check\": \"Application must utilize bidirectional authentication for\ncryptographic device communication.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement bidirectional (client-server handshake) for\nestablishing cryptographic communication.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26910.rb","line":21},"id":"V-26910","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.4e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000121,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000102,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.034002,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000243,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000159,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000104,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.051369,"start_time":"2017-09-19 23:27:20 -0400"}]},{"title":"Ensure Elasticsearch PKI validation meets organizational requirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as valid certification path, trusted anchor.","impact":0.5,"refs":[],"tags":{"nist":["IA-3 (2)","Rev_3"],"severity":"medium","rid":"SV-34192r1_rule","cci":"CCI-000781","check":"Application must utilize approved cryptography to authenticate\ndevices.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement approved cryptography to authenticate devices.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26912\" do\n  title \"Ensure Elasticsearch PKI validation meets organizational requirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as valid certification path, trusted anchor.\"\n  impact 0.5\n  tag \"nist\": [\"IA-3 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34192r1_rule\"\n  tag \"cci\": \"CCI-000781\"\n  tag \"check\": \"Application must utilize approved cryptography to authenticate\ndevices.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement approved cryptography to authenticate devices.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26912.rb","line":1},"id":"V-26912"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-4 (5)","Rev_3"],"severity":"medium","rid":"SV-34193r1_rule","stig_id":"SRG-APP-000162","cci":"CCI-000802","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26913\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-4 (5)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34193r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000162\"\n  tag \"cci\": \"CCI-000802\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26913.rb","line":1},"id":"V-26913"},{"title":"Utilize Central Authentication server to meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-4 e","Rev_4"],"severity":"medium","rid":"SV-34194r1_rule","stig_id":"SRG-APP-000163","cci":"CCI-000795","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26914\" do\n  title \"Utilize Central Authentication server to meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-4 e\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34194r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000163\"\n  tag \"cci\": \"CCI-000795\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26914.rb","line":1},"id":"V-26914"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (a)","Rev_4"],"severity":"medium","rid":"SV-34195r1_rule","stig_id":"SRG-APP-000164","cci":"CCI-000205","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26915\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34195r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000164\"\n  tag \"cci\": \"CCI-000205\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26915.rb","line":1},"id":"V-26915"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (e)","Rev_4"],"severity":"medium","rid":"SV-34196r1_rule","stig_id":"SRG-APP-000165","cci":"CCI-000200","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26916\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (e)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34196r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000165\"\n  tag \"cci\": \"CCI-000200\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26916.rb","line":1},"id":"V-26916"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (a)","Rev_4"],"severity":"medium","rid":"SV-34198r1_rule","stig_id":"SRG-APP-000166","cci":"CCI-000192","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26918\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34198r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000166\"\n  tag \"cci\": \"CCI-000192\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26918.rb","line":1},"id":"V-26918"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (a)","Rev_4"],"severity":"medium","rid":"SV-34199r1_rule","stig_id":"SRG-APP-000167","cci":"CCI-000193","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26919\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34199r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000167\"\n  tag \"cci\": \"CCI-000193\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26919.rb","line":1},"id":"V-26919"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (a)","Rev_4"],"severity":"medium","rid":"SV-34200r1_rule","stig_id":"SRG-APP-000168","cci":"CCI-000194","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26920\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34200r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000168\"\n  tag \"cci\": \"CCI-000194\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26920.rb","line":1},"id":"V-26920"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (a)","Rev_4"],"severity":"medium","rid":"SV-34201r1_rule","stig_id":"SRG-APP-000169","cci":"CCI-001619","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26921\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34201r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000169\"\n  tag \"cci\": \"CCI-001619\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26921.rb","line":1},"id":"V-26921"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (b)","Rev_4"],"severity":"medium","rid":"SV-34202r1_rule","stig_id":"SRG-APP-000170","cci":"CCI-000195","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26922\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (b)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34202r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000170\"\n  tag \"cci\": \"CCI-000195\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26922.rb","line":1},"id":"V-26922"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (c)","Rev_4"],"severity":"medium","rid":"SV-34203r1_rule","stig_id":"SRG-APP-000171","cci":"CCI-000196","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26923\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34203r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000171\"\n  tag \"cci\": \"CCI-000196\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26923.rb","line":1},"id":"V-26923"},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (c)","Rev_4"],"severity":"medium","rid":"SV-34204r1_rule","stig_id":"SRG-APP-000172","cci":"CCI-000197","check":"Application must utilize approved cryptography to protect\nremote access sessions.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26924\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34204r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000172\"\n  tag \"cci\": \"CCI-000197\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26924.rb","line":21},"id":"V-26924","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.8e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000182,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00013,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.050804,"start_time":"2017-09-19 23:27:20 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000155,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000131,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.041751,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (d)","Rev_4"],"severity":"medium","rid":"SV-34205r1_rule","stig_id":"SRG-APP-000173","cci":"CCI-000198","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26925\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (d)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34205r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000173\"\n  tag \"cci\": \"CCI-000198\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26925.rb","line":1},"id":"V-26925"},{"title":"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (1) (d)","Rev_4"],"severity":"medium","rid":"SV-34206r1_rule","stig_id":"SRG-APP-000174","cci":"CCI-000199","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26926\" do\n  title \"Ensure Elasticsearch passwords and credentials meet organizational\nrequirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (d)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34206r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000174\"\n  tag \"cci\": \"CCI-000199\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26926.rb","line":1},"id":"V-26926"},{"title":"Ensure Elasticsearch PKI validation meets organizational requirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as valid certification path, trusted anchor,\ncertificate revocation lists.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (2) (a)","Rev_4"],"severity":"medium","rid":"SV-34207r1_rule","stig_id":"SRG-APP-000175","cci":"CCI-000185","check":"Must perform manual verification of certificates paths using\n3rd party tools, like OpenSSl verify function, described:\nhttps://wiki.openssl.org/index.php/Manual:Verify(1)\n\nIf the certificate is not valid, this is a finding.","fix":"Obtain a new certificate from approved service provider. Perform\nvalidation of the certifcate until the path is valid.\n\nUpdate the certificates in elasticsearch.yml to the valid certificate\n\n$vi elasticsearch.yml\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt "},"code":"control \"V-26927\" do\n  title \"Ensure Elasticsearch PKI validation meets organizational requirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as valid certification path, trusted anchor,\ncertificate revocation lists.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (2) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34207r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000175\"\n  tag \"cci\": \"CCI-000185\"\n  tag \"check\": \"Must perform manual verification of certificates paths using\n3rd party tools, like OpenSSl verify function, described:\nhttps://wiki.openssl.org/index.php/Manual:Verify(1)\n\nIf the certificate is not valid, this is a finding.\"\n  tag \"fix\": \"Obtain a new certificate from approved service provider. Perform\nvalidation of the certifcate until the path is valid.\n\nUpdate the certificates in elasticsearch.yml to the valid certificate\n\n$vi elasticsearch.yml\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt \"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\n\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26927.rb","line":11},"id":"V-26927","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000162,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.046599,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.00025,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000144,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Ensure Elasticsearch PKI validation meets organizational requirements.","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-5 (2) (c)","Rev_4"],"severity":"medium","rid":"SV-34210r1_rule","stig_id":"SRG-APP-000177","cci":"CCI-000187","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26930\" do\n  title \"Ensure Elasticsearch PKI validation meets organizational requirements.\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (2) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34210r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000177\"\n  tag \"cci\": \"CCI-000187\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26930.rb","line":1},"id":"V-26930"},{"title":"Configure organization approved encryption","desc":"Configure X-Pack to use an organization approved FIPS 140-2 java\ncryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["IA-7","Rev_4"],"severity":"medium","rid":"SV-34215r1_rule","stig_id":"SRG-APP-000179","cci":"CCI-000803","check":"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26935\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack to use an organization approved FIPS 140-2 java\ncryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"IA-7\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34215r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000179\"\n  tag \"cci\": \"CCI-000803\"\n  tag \"check\": \"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26935.rb","line":21},"id":"V-26935","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000115,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000101,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000107,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.093352,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000302,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000164,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00014,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000128,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.041689,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Use X-Pack authentication and authorization for all user types, even\nanonymous access","desc":"As appropriate, grant Role Based Access Control for organizational\nusers, non-organizational users, and anonymous users.","impact":0.5,"refs":[],"tags":{"nist":["IA-8","Rev_4"],"severity":"medium","rid":"SV-34217r1_rule","stig_id":"SRG-APP-000180","cci":"CCI-000804","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26937\" do\n  title \"Use X-Pack authentication and authorization for all user types, even\nanonymous access\"\n  desc  \"As appropriate, grant Role Based Access Control for organizational\nusers, non-organizational users, and anonymous users.\"\n  impact 0.5\n  tag \"nist\": [\"IA-8\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34217r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000180\"\n  tag \"cci\": \"CCI-000804\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26937.rb","line":1},"id":"V-26937"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["CM-5 (1)","Rev_3"],"severity":"medium","rid":"SV-34220r1_rule","stig_id":"SRG-APP-000130","cci":"CCI-000347","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to support the auditing of\nenformement actions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26940\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34220r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000130\"\n  tag \"cci\": \"CCI-000347\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to support the auditing of\nenformement actions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26940.rb","line":1},"id":"V-26940"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["MA-4 (1)","Rev_3"],"severity":"medium","rid":"SV-34229r1_rule","stig_id":"SRG-APP-NA","cci":"CCI-000880","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to audit non-local\nmaintenacne and diagnositic sessions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-26947\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34229r1_rule\"\n  tag \"stig_id\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-000880\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit non-local\nmaintenacne and diagnositic sessions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26947.rb","line":23},"id":"V-26947","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.000263,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000176,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000107,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000136,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000223,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack to use an organization approved FIPS 140-2 java\ncryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["MA-4 (4) (a)","Rev_4"],"severity":"medium","rid":"SV-34231r1_rule","stig_id":"SRG-APP-000183","cci":"CCI-000884","check":"Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26948\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack to use an organization approved FIPS 140-2 java\ncryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (4) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34231r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000183\"\n  tag \"cci\": \"CCI-000884\"\n  tag \"check\": \"Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26948.rb","line":21},"id":"V-26948","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.2e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000246,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000146,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.0426,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000231,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000203,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000202,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000123,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.036733,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["MA-4 (6)","Rev_3"],"severity":"medium","rid":"SV-34236r1_rule","stig_id":"SRG-APP-000184","cci":"CCI-000888","check":"Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26953\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (6)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34236r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000184\"\n  tag \"cci\": \"CCI-000888\"\n  tag \"check\": \"Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26953.rb","line":21},"id":"V-26953","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000146,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000209,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000122,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036179,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000245,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000113,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000168,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.042918,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["MA-4 c","Rev_4"],"severity":"medium","rid":"SV-34237r1_rule","stig_id":"SRG-APP-000185","cci":"CCI-000877","check":"Application must utilize approved cryptography to establish\nstring identification and authentication techniques.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when identifing and authenticating\nnon-local sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-26954\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 c\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34237r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000185\"\n  tag \"cci\": \"CCI-000877\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nstring identification and authentication techniques.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when identifing and authenticating\nnon-local sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26954.rb","line":21},"id":"V-26954","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.4e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00012,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031388,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000161,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000166,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.9e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031052,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["IA-2","Rev_4"],"severity":"medium","rid":"SV-34260r1_rule","stig_id":"SRG-APP-000148","cci":"CCI-000764","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-26972\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34260r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000148\"\n  tag \"cci\": \"CCI-000764\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-26972.rb","line":1},"id":"V-26972"},{"title":"Enable secured communication to and within the Elasticsearch cluster","desc":"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is SSL Mutual Authentication.","impact":0.5,"refs":[],"tags":{"nist":["SC-23","Rev_4"],"severity":"medium","rid":"SV-34309r1_rule","stig_id":"SRG-APP-000219","cci":"CCI-001184","check":"Application must utilize approved cryptography to ensure\nauthentication of both client and server during the entire session..\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Ensure authentication of both client and server during the entire\nsession.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27015\" do\n  title \"Enable secured communication to and within the Elasticsearch cluster\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is SSL Mutual Authentication.\"\n  impact 0.5\n  tag \"nist\": [\"SC-23\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34309r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000219\"\n  tag \"cci\": \"CCI-001184\"\n  tag \"check\": \"Application must utilize approved cryptography to ensure\nauthentication of both client and server during the entire session..\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Ensure authentication of both client and server during the entire\nsession.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27015.rb","line":21},"id":"V-27015","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000156,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.4e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000119,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031996,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000202,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00011,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.00011,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.031432,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Encrypt data at rest","desc":"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.","impact":0.5,"refs":[],"tags":{"nist":["SC-28","Rev_4"],"severity":"medium","rid":"SV-34318r1_rule","stig_id":"SRG-APP-000231","cci":"CCI-001199","check":"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.","fix":"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html"},"code":"control \"V-27024\" do\n  title \"Encrypt data at rest\"\n  desc  \"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.\"\n  impact 0.5\n  tag \"nist\": [\"SC-28\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34318r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000231\"\n  tag \"cci\": \"CCI-001199\"\n  tag \"check\": \"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.\"\n  tag \"fix\": \"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27024.rb","line":1},"id":"V-27024"},{"title":"Control network access to Elasticsearch","desc":"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.","impact":0.5,"refs":[],"tags":{"nist":["SC-4 (1)","Rev_3"],"severity":"medium","rid":"SV-34329r1_rule","stig_id":"SRG-APP-000244","cci":"CCI-001091","check":"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \"Managed\naccess control points\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \"Managed\naccess control points\":\n\n$cat elasticsearch.yml | grep \"xpack.security.http.filter\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \"Managed access control points\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \"{}\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\"Managed access control points\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET \"http://<elasticsearch>:9200/_cluster/settings\"\n\nIf these configuration setting are disabled, or not pointing to the \"Managed\naccess control points\", this is a finding. ","fix":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \"Managed access control points\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"},"code":"control \"V-27035\" do\n  title \"Control network access to Elasticsearch\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"SC-4 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34329r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000244\"\n  tag \"cci\": \"CCI-001091\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only sepecific IP behind hardware/software \\\"Managed\naccess control points\\\" are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  \\\"Managed\naccess control points\\\":\n\n$cat elasticsearch.yml | grep \\\"xpack.security.http.filter\\\", Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: \\\"Managed access control points\\\";\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to \\\"{}\\\" OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n\\\"Managed access control points\\\"; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET \\\"http://<elasticsearch>:9200/_cluster/settings\\\"\n\nIf these configuration setting are disabled, or not pointing to the \\\"Managed\naccess control points\\\", this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ESHOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.conf:\n\n\n$ sudo su - elasticsearch\n$ vi $ESHOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: \\\"Managed access control points\\\"\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    cmd = \"curl -H 'Content-Type: application/json' https://#{ELASTIC_IP}:#{ELASTIC_PORT}/_cluster/settings -k -u #{ES_ADMIN}:#{ES_PASS}\"\n    describe json(command:cmd) do\n      its('persistent') { should be_empty }\n      its('transient') { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27035.rb","line":40},"id":"V-27035","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.enabled\"] should eq true","run_time":0.00018,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"","run_time":0.000185,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.filter.deny\"] should eq \"_all\"","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  persistent should be empty","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Json  transient should be empty","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch","impact":0.5,"refs":[],"tags":{"nist":["SC-8 (2)","Rev_3"],"severity":"medium","rid":"SV-34354r1_rule","stig_id":"SRG-APP-NA","cci":"CCI-001129","check":"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27059\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\"\n  impact 0.5\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34354r1_rule\"\n  tag \"stig_id\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001129\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27059.rb","line":21},"id":"V-27059","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":9.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":8.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.0e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.1e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.028621,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000227,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000131,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.03117,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["SC-9","Rev_3"],"severity":"medium","rid":"SV-34355r1_rule","stig_id":"SRG-APP-NA","cci":"CCI-001130","check":"Application must utilize approved cryptography to establish\nconfidentiality of transmitted data.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement confidentiality measures of transmitted data.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27060\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34355r1_rule\"\n  tag \"stig_id\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001130\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nconfidentiality of transmitted data.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement confidentiality measures of transmitted data.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27060.rb","line":21},"id":"V-27060","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000159,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.9e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000182,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.8e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.109469,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000167,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000138,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000182,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000133,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.057575,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["SC-9 (1)","Rev_3"],"severity":"medium","rid":"SV-34356r1_rule","stig_id":"SRG-APP-000264","cci":"CCI-001131","check":"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27061\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34356r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000264\"\n  tag \"cci\": \"CCI-001131\"\n  tag \"check\": \"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27061.rb","line":21},"id":"V-27061","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000168,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.00019,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.5e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000126,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.3e-05,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.053144,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000214,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000225,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000125,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000116,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.048795,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["SC-9 (2)","Rev_3"],"severity":"medium","rid":"SV-34357r1_rule","stig_id":"SRG-APP-000230","cci":"CCI-001132","check":"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27062\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34357r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000230\"\n  tag \"cci\": \"CCI-001132\"\n  tag \"check\": \"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27062.rb","line":21},"id":"V-27062","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000165,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000106,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000326,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000239,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036923,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000152,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000145,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.00015,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.0001,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.044417,"start_time":"2017-09-19 23:27:21 -0400"}]},{"title":"Disable dynamic templates","desc":"Dynamic templates allows for user input to be processed without\nverifying it against a set of expected values. Turning off dynamic templates,\nand creating templates for input can handle type validation.","impact":0.5,"refs":[],"tags":{"nist":["SI-10","Rev_4"],"severity":"medium","rid":"SV-34358r1_rule","stig_id":"SRG-APP-000251","cci":"CCI-001310","check":"Application must utilize approved cryptography to validate data\ninput.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures to validate data inputs.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27063\" do\n  title \"Disable dynamic templates\"\n  desc  \"Dynamic templates allows for user input to be processed without\nverifying it against a set of expected values. Turning off dynamic templates,\nand creating templates for input can handle type validation.\"\n  impact 0.5\n  tag \"nist\": [\"SI-10\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34358r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000251\"\n  tag \"cci\": \"CCI-001310\"\n  tag \"check\": \"Application must utilize approved cryptography to validate data\ninput.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures to validate data inputs.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27063.rb","line":21},"id":"V-27063","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000247,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000113,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000132,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000187,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000106,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.075188,"start_time":"2017-09-19 23:27:21 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000179,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000189,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000221,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000185,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.042216,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["SI-11 a","Rev_3"],"severity":"medium","rid":"SV-34359r1_rule","stig_id":"SRG-APP-000265","cci":"CCI-001311","check":"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-27064\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"SI-11 a\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34359r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000265\"\n  tag \"cci\": \"CCI-001311\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the nessacary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occured.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27064.rb","line":24},"id":"V-27064","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.enabled\"] should eq true","run_time":0.0003,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.outputs\"] should include \"logfile\"","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"","run_time":0.000205,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"","run_time":0.000117,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Information in transit is protected by standard TLS communication, and\ncan be visible to specific system monitoring tools","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["SI-4 (10)","Rev_3"],"severity":"medium","rid":"SV-34387r1_rule","stig_id":"SRG-APP-000282","cci":"CCI-001272","check":"Application must utilize approved cryptography to protect\npasswords in transmission.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27092\" do\n  title \"Information in transit is protected by standard TLS communication, and\ncan be visible to specific system monitoring tools\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SI-4 (10)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34387r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000282\"\n  tag \"cci\": \"CCI-001272\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\npasswords in transmission.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27092.rb","line":21},"id":"V-27092","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000128,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.00011,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.036443,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000135,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000101,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000105,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.068814,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Encrypt data at rest","desc":"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.","impact":0.5,"refs":[],"tags":{"nist":["MP-4 (1)","Rev_3"],"severity":"medium","rid":"SV-34417r1_rule","stig_id":"SRG-APP-000188","cci":"CCI-001019","check":"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.","fix":"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html"},"code":"control \"V-27120\" do\n  title \"Encrypt data at rest\"\n  desc  \"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.\"\n  impact 0.5\n  tag \"nist\": [\"MP-4 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34417r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000188\"\n  tag \"cci\": \"CCI-001019\"\n  tag \"check\": \"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.\"\n  tag \"fix\": \"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27120.rb","line":1},"id":"V-27120"},{"title":"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster","desc":"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.","impact":0.5,"refs":[],"tags":{"nist":["SC-11","Rev_4"],"severity":"medium","rid":"SV-34428r1_rule","stig_id":"SRG-APP-000191","cci":"CCI-001135","check":"Application must utilize approved cryptography to protect the\ncommunication path between entities.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Implement protective measures when establishing a trusted\ncommunication path between entities.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27130\" do\n  title \"Encrypt information in transit both at the Elasticsearch perimeter and\nwithin the Elasticsearch cluster\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organization approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-11\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34428r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000191\"\n  tag \"cci\": \"CCI-001135\"\n  tag \"check\": \"Application must utilize approved cryptography to protect the\ncommunication path between entities.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when establishing a trusted\ncommunication path between entities.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27130.rb","line":21},"id":"V-27130","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000124,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":9.7e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.091196,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000158,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":9.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000101,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.081827,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Utilize tools that perform commercial off-the-shelf integrity checks","desc":null,"impact":0.5,"refs":[],"tags":{"nist":["SI-7","Rev_3"],"severity":"medium","rid":"SV-34436r1_rule","stig_id":"SRG-APP-000262","cci":"CCI-001297","check":"The AIDE package must be installed if it is to be available for\nintegrity checking.\n\nRun the following command to determine if the aide package is installed:\n\n$ rpm -q aide\n\nIf the package is not installed, this is a finding.","fix":"Install the AIDE package with the command:\n\n$ sudo yum install aide"},"code":"control \"V-27137\" do\n  title \"Utilize tools that perform commercial off-the-shelf integrity checks\"\n  impact 0.5\n  tag \"nist\": [\"SI-7\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34436r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000262\"\n  tag \"cci\": \"CCI-001297\"\n  tag \"check\": \"The AIDE package must be installed if it is to be available for\nintegrity checking.\n\nRun the following command to determine if the aide package is installed:\n\n$ rpm -q aide\n\nIf the package is not installed, this is a finding.\"\n  tag \"fix\": \"Install the AIDE package with the command:\n\n$ sudo yum install aide\"\n\n  begin\n    describe command('aide') do\n      it { should exist}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\n\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27137.rb","line":5},"id":"V-27137","results":[{"status":"failed","code_desc":"Command aide should exist","run_time":0.057924,"start_time":"2017-09-19 23:27:22 -0400","message":"expected Command aide to exist"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["SC-13","Rev_3"],"severity":"medium","rid":"SV-34439r1_rule","stig_id":"SRG-APP-000196","cci":"CCI-001144","check":"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27140\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34439r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000196\"\n  tag \"cci\": \"CCI-001144\"\n  tag \"check\": \"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27140.rb","line":21},"id":"V-27140","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000163,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000105,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000175,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.05576,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.00023,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.0002,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000199,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000166,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.033862,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Monitor activity on Elasticsearch","desc":"Deploy security analytics to monitor the behavior of system users and\nadministrators. Audit events should be exportable, searchable, filterable, and\nsummarized in real time.","impact":0.5,"refs":[],"tags":{"nist":["AU-7 (1)","Rev_4"],"severity":"medium","rid":"SV-34444r1_rule","stig_id":"SRG-APP-000115","cci":"CCI-000158","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-27145\" do\n  title \"Monitor activity on Elasticsearch\"\n  desc  \"Deploy security analytics to monitor the behavior of system users and\nadministrators. Audit events should be exportable, searchable, filterable, and\nsummarized in real time.\"\n  impact 0.5\n  tag \"nist\": [\"AU-7 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34444r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000115\"\n  tag \"cci\": \"CCI-000158\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27145.rb","line":1},"id":"V-27145"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-8 a","Rev_4"],"severity":"medium","rid":"SV-34445r1_rule","stig_id":"SRG-APP-000116","cci":"CCI-000159","check":"The Elasticsearch application's auditing system supports this\nrequirement and cannot be configured to be out of compliance. Every audit\nrecord in elasticsearch includes a timestamp.\n\nThis is a permanent not a finding.","fix":"This requirement is a permanent not a finding. No fix is\nrequired."},"code":"control \"V-27146\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-8 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34445r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000116\"\n  tag \"cci\": \"CCI-000159\"\n  tag \"check\": \"The Elasticsearch application's auditing system supports this\nrequirement and cannot be configured to be out of compliance. Every audit\nrecord in elasticsearch includes a timestamp.\n\nThis is a permanent not a finding.\"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27146.rb","line":5},"id":"V-27146","results":[{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":1.3e-05,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Synchronize OS clocks with NTP","desc":"Synchronize operating system clocks with an organizational\nauthoritative source using NTP.","impact":0.5,"refs":[],"tags":{"nist":["AU-8 (1)","Rev_3"],"severity":"medium","rid":"SV-34446r1_rule","stig_id":"SRG-APP-000117","cci":"CCI-000160","check":"To verify that a remote NTP service is configured for time\nsynchronization, open the following file:\n\n/etc/chrony.conf\n\nin the case the system in question is configured to use the chronyd as the NTP\ndaemon (default setting)\n\n/etc/ntp.conf\n\n in the case the system in question is configured to use the ntpd as the NTP\ndaemon\n\nIn the file, there should be a section similar to the following:\n\nserver ntpserver\n\nIf this is not the case, this is a finding.","fix":"Depending on specific functional requirements of a concrete\nproduction environment, the Red Hat Enterprise Linux 7 Server system can be\nconfigured to utilize the services of theÃÂ chronydÃÂ NTP daemon\n(the default), or services of theÃÂ ntpdÃÂ NTP daemon. Refer\ntoÃÂ https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Configuring_NTP_Using_the_chrony_Suite.htmlÃÂ for\nmore detailed comparison of the features of both of the choices, and for\nfurther guidance how to choose between the two NTP daemons.\n\nTo specify a remote NTP server for time synchronization, perform the following:\n\n\n* if the system is configured to use theÃÂ chronydÃÂ as the NTP\ndaemon (the default), edit the fileÃÂ /etc/chrony.confÃÂ as\nfollows,\n\n* if the system is configured to use theÃÂ ntpdÃÂ as the NTP\ndaemon, edit the fileÃÂ /etc/ntp.confÃÂ as documented below.\n\nAdd or correct the following lines, substituting the IP or hostname of a remote\nNTP server forÃÂ ntpserver:\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time\ndata."},"code":"control \"V-27147\" do\n  title \"Synchronize OS clocks with NTP\"\n  desc  \"Synchronize operating system clocks with an organizational\nauthoritative source using NTP.\"\n  impact 0.5\n  tag \"nist\": [\"AU-8 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34446r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000117\"\n  tag \"cci\": \"CCI-000160\"\n  tag \"check\": \"To verify that a remote NTP service is configured for time\nsynchronization, open the following file:\n\n/etc/chrony.conf\n\nin the case the system in question is configured to use the chronyd as the NTP\ndaemon (default setting)\n\n/etc/ntp.conf\n\n in the case the system in question is configured to use the ntpd as the NTP\ndaemon\n\nIn the file, there should be a section similar to the following:\n\nserver ntpserver\n\nIf this is not the case, this is a finding.\"\n  tag \"fix\": \"Depending on specific functional requirements of a concrete\nproduction environment, the Red Hat Enterprise Linux 7 Server system can be\nconfigured to utilize the services of theÃ\\u0082Â chronydÃ\\u0082Â NTP daemon\n(the default), or services of theÃ\\u0082Â ntpdÃ\\u0082Â NTP daemon. Refer\ntoÃ\\u0082Â https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Configuring_NTP_Using_the_chrony_Suite.htmlÃ\\u0082Â for\nmore detailed comparison of the features of both of the choices, and for\nfurther guidance how to choose between the two NTP daemons.\n\nTo specify a remote NTP server for time synchronization, perform the following:\n\n\n* if the system is configured to use theÃ\\u0082Â chronydÃ\\u0082Â as the NTP\ndaemon (the default), edit the fileÃ\\u0082Â /etc/chrony.confÃ\\u0082Â as\nfollows,\n\n* if the system is configured to use theÃ\\u0082Â ntpdÃ\\u0082Â as the NTP\ndaemon, edit the fileÃ\\u0082Â /etc/ntp.confÃ\\u0082Â as documented below.\n\nAdd or correct the following lines, substituting the IP or hostname of a remote\nNTP server forÃ\\u0082Â ntpserver:\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time\ndata.\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27147.rb","line":1},"id":"V-27147"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-9","Rev_4"],"severity":"medium","rid":"SV-34447r1_rule","stig_id":"SRG-APP-000118","cci":"CCI-000162","check":"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output paramter in elasticsearch.yml and typically all\nappear in /var/log/audit. To see the owner of a given log file, run the\nfollowing command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.","fix":"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/audit.\n\nFor each log file LOGFILE referenced in xpack.security.audit.output from\nelasticsearch.yml, run the following command to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE"},"code":"control \"V-27148\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34447r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000118\"\n  tag \"cci\": \"CCI-000162\"\n  tag \"check\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output paramter in elasticsearch.yml and typically all\nappear in /var/log/audit. To see the owner of a given log file, run the\nfollowing command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.\"\n  tag \"fix\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/audit.\n\nFor each log file LOGFILE referenced in xpack.security.audit.output from\nelasticsearch.yml, run the following command to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27148.rb","line":1},"id":"V-27148"},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["SC-13 (1)","Rev_3"],"severity":"medium","rid":"SV-34449r1_rule","stig_id":"SRG-APP-000197","cci":"CCI-001145","check":"Application must utilize approved cryptography to protect\nunclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography to protect unclassified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27150\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34449r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000197\"\n  tag \"cci\": \"CCI-001145\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nunclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to protect unclassified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27150.rb","line":21},"id":"V-27150","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000217,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.9e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000338,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.00019,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.031309,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000214,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000201,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000154,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000204,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.035731,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["SC-13 (2)","Rev_3"],"severity":"medium","rid":"SV-34452r1_rule","stig_id":"SRG-APP-000198","cci":"CCI-001146","check":"Application must utilize approved cryptography to protect\nclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography to protect classified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27153\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34452r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000198\"\n  tag \"cci\": \"CCI-001146\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to protect classified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27153.rb","line":21},"id":"V-27153","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.00014,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":8.8e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000123,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000158,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.032748,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000152,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000311,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000156,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000114,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.036113,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["SC-13 (3)","Rev_3"],"severity":"medium","rid":"SV-34453r1_rule","stig_id":"SRG-APP-000199","cci":"CCI-001147","check":"Application must utilize approved cryptography for data\nseperation.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography for data seperations.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27154\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34453r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000199\"\n  tag \"cci\": \"CCI-001147\"\n  tag \"check\": \"Application must utilize approved cryptography for data\nseperation.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography for data seperations.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27154.rb","line":21},"id":"V-27154","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000344,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":9.6e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000131,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000142,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.139245,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000174,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000127,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000113,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000118,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.053855,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Configure organization approved encryption","desc":"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.","impact":0.5,"refs":[],"tags":{"nist":["SC-13 (4)","Rev_3"],"severity":"medium","rid":"SV-34454r1_rule","stig_id":"SRG-APP-NA","cci":"CCI-001148","check":"Application must utilize approved cryptography to establish\nimplement digital signatures.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.","fix":"Employ approved cryptography to implment digital signatures.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27155\" do\n  title \"Configure organization approved encryption\"\n  desc  \"Configure X-Pack Security to use an organization approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34454r1_rule\"\n  tag \"stig_id\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001148\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nimplement digital signatures.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these setting are not set or the underlining certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to implment digital signatures.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe command(\"curl -H 'Content-Type: application/json' http://#{ELASTIC_IP}:#{ELASTIC_PORT}/\") do\n      its('exit_status') { should_not cmp 0 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27155.rb","line":21},"id":"V-27155","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.0002,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":0.000109,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000148,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true","run_time":0.000305,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true","run_time":0.000133,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.033781,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000146,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000126,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.000103,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000104,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command curl -H 'Content-Type: application/json' http://0.0.0.0:9200/ exit_status should not cmp == 0","run_time":0.03787,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Move Audit records off Elasticsearch boxes","desc":"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users.","impact":0.5,"refs":[],"tags":{"nist":["AU-9","Rev_4"],"severity":"medium","rid":"SV-34459r1_rule","stig_id":"SRG-APP-000120","cci":"CCI-000164","check":"The /var/log/audit folder must have mode 0644 or less\npermissive.\n\nTo check the permissions of /var/log/audit, run the command:\n\n $ ls -l /var/log/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.","fix":"To properly set the permissions of /var/log/audit, run the\ncommand:\n\n$ sudo chmod 0644 /var/log/audit  "},"code":"control \"V-27160\" do\n  title \"Move Audit records off Elasticsearch boxes\"\n  desc  \"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34459r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000120\"\n  tag \"cci\": \"CCI-000164\"\n  tag \"check\": \"The /var/log/audit folder must have mode 0644 or less\npermissive.\n\nTo check the permissions of /var/log/audit, run the command:\n\n $ ls -l /var/log/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.\"\n  tag \"fix\": \"To properly set the permissions of /var/log/audit, run the\ncommand:\n\n$ sudo chmod 0644 /var/log/audit  \"\n\n  begin\n    describe file('/var/log/audit') do\n      its('mode') { should cmp <= 0644}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27160.rb","line":5},"id":"V-27160","results":[{"status":"failed","code_desc":"File /var/log/audit mode should cmp <= 420","run_time":0.035049,"start_time":"2017-09-19 23:27:22 -0400","message":"\nexpected it to be <= 420\n     got: 488\n\n(compared using `cmp` matcher)\n"}]},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.","impact":0.5,"refs":[],"tags":{"nist":["AU-9","Rev_4"],"severity":"medium","rid":"SV-34462r1_rule","stig_id":"SRG-APP-000121","cci":"CCI-001493","check":"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output paramter in elasticsearch.yml and typically all\nappear in /var/log/audit. To see the owner of a given log file, run the\nfollowing command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.","fix":"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/audit.\n\nFor each log file LOGFILE referenced in /etc/rsyslog.conf, run the following\ncommand to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE"},"code":"control \"V-27163\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34462r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000121\"\n  tag \"cci\": \"CCI-001493\"\n  tag \"check\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output paramter in elasticsearch.yml and typically all\nappear in /var/log/audit. To see the owner of a given log file, run the\nfollowing command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.\"\n  tag \"fix\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/audit.\n\nFor each log file LOGFILE referenced in /etc/rsyslog.conf, run the following\ncommand to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27163.rb","line":1},"id":"V-27163"},{"title":"Generate Audits to assist monitoring and alerting of activities on the\nsystem","desc":"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol. Implement OS\nlevel access controls on audit logs. Move audit logs off of elasticsearch\nsystems and into central audit logging solution.","impact":0.5,"refs":[],"tags":{"nist":["AU-9","Rev_4"],"severity":"medium","rid":"SV-34463r1_rule","stig_id":"SRG-APP-000122","cci":"CCI-001494","check":"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to access audit settings.\n\nAs the application administrator (shown here as \"elasticsearch\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.","fix":"Configure elasticsearch audit settings to be controlled by\nauthorized users.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-27164\" do\n  title \"Generate Audits to assist monitoring and alerting of activities on the\nsystem\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol. Implement OS\nlevel access controls on audit logs. Move audit logs off of elasticsearch\nsystems and into central audit logging solution.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34463r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000122\"\n  tag \"cci\": \"CCI-001494\"\n  tag \"check\": \"Note: The following instructions use the ESHOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nESHOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to access audit settings.\n\nAs the application administrator (shown here as \\\"elasticsearch\\\"), verify the\npermissions for ESHOME:\n\n$ ls -la ${ESHOME?}\n\nIf anything in ESHOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to be controlled by\nauthorized users.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27164.rb","line":1},"id":"V-27164"},{"title":"Utilize cluster keys as well as supported clients to prevent hijacking\nof connections or unexpected contention of updates. Elasticsearch does not have\na concept of sessions; but with X-pack Security, communication ids are unique,\nrandom, and signed to prevent tampering.","desc":"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users. Move audit logs off of local machines and\nbackup to a audit log management system.","impact":0.5,"refs":[],"tags":{"nist":["AU-9","Rev_4"],"severity":"medium","rid":"SV-34464r1_rule","stig_id":"SRG-APP-000123","cci":"CCI-001495","check":"The elasticsearch.yml file controls audit function for the\napplication. Protection of this file is critical for system security.\n\nTo check the ownership of elasticsearch.yml, run the command:\n\n $ ls -lL ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following owner:\nelasticsearch If it does not, this is a finding.\n\nThe elasticsearch.yml must have mode 0640 or less permissive.\n\nTo check the permissions of elasticsearch.yml, run the command:\n\n $ ls -l ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.","fix":"To properly set the owner of /etc/shadow, run the command:\n\n$ sudo chown elasticsearch elasticsearch.yml    --           ##   TODO add text\naround adding rule "},"code":"control \"V-27165\" do\n  title \"Utilize cluster keys as well as supported clients to prevent hijacking\nof connections or unexpected contention of updates. Elasticsearch does not have\na concept of sessions; but with X-pack Security, communication ids are unique,\nrandom, and signed to prevent tampering.\"\n  desc  \"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users. Move audit logs off of local machines and\nbackup to a audit log management system.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34464r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000123\"\n  tag \"cci\": \"CCI-001495\"\n  tag \"check\": \"The elasticsearch.yml file controls audit function for the\napplication. Protection of this file is critical for system security.\n\nTo check the ownership of elasticsearch.yml, run the command:\n\n $ ls -lL ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following owner:\nelasticsearch If it does not, this is a finding.\n\nThe elasticsearch.yml must have mode 0640 or less permissive.\n\nTo check the permissions of elasticsearch.yml, run the command:\n\n $ ls -l ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.\"\n  tag \"fix\": \"To properly set the owner of /etc/shadow, run the command:\n\n$ sudo chown elasticsearch elasticsearch.yml    --           ##   TODO add text\naround adding rule \"\n\n  begin\n    describe file(ELASTICSEARCH_CONF) do\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n      its('mode') { should cmp <= 0640 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27165.rb","line":24},"id":"V-27165","results":[{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml owner should eq \"elasticsearch\"","run_time":0.000283,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml group should eq \"elasticsearch\"","run_time":0.000136,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"File /etc/elasticsearch/elasticsearch.yml mode should cmp <= 416","run_time":0.000274,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":null,"desc":null,"impact":0.5,"refs":[],"tags":{"nist":["AU-9 (1)","Rev_4"],"severity":"medium","rid":"SV-34465r1_rule","stig_id":"SRG-APP-000124","cci":"CCI-000165","check":"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service. This requirement\nis NA.","fix":"This requirement is NA. No fix is required."},"code":"control \"V-27166\" do\n  impact 0.5\n  tag \"nist\": [\"AU-9 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34465r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000124\"\n  tag \"cci\": \"CCI-000165\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service. This requirement\nis NA.\"\n  tag \"fix\": \"This requirement is NA. No fix is required.\"\n\n  only_if do\n    false\n  end\n\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27166.rb","line":5},"id":"V-27166","results":[{"status":"skipped","code_desc":"Operating System Detection","skip_message":"Skipped control due to only_if condition.","resource":"Operating System Detection","run_time":6.0e-06,"start_time":"2017-09-19 23:27:22 -0400"}]},{"title":"Move Audit records off Elasticsearch boxes","desc":"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.","impact":0.5,"refs":[],"tags":{"nist":["AU-9 (2)","Rev_4"],"severity":"medium","rid":"SV-34467r1_rule","stig_id":"SRG-APP-000125","cci":"CCI-001348","check":"Check Elasticsearch.yml settings and existing audit records are\nbeing recorded to an external system or media.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.","fix":"Configure elasticsearch audit settings to an external system or\nmedia.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"},"code":"control \"V-27168\" do\n  title \"Move Audit records off Elasticsearch boxes\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34467r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000125\"\n  tag \"cci\": \"CCI-001348\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records are\nbeing recorded to an external system or media.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to an external system or\nmedia.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27168.rb","line":1},"id":"V-27168"},{"title":"Setup security settings to utilize organizational attained\ncertificates within the Elasticsearch cluster","desc":"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch utilizes organizational attained\ncertificates.","impact":0.5,"refs":[],"tags":{"nist":["SC-17","Rev_4"],"severity":"medium","rid":"SV-34471r1_rule","stig_id":"SRG-APP-000205","cci":"CCI-001159","check":"Application must obtain public key certificates from an\napporved service provider.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to approved public key certificates.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\" ]\n\nIf these certificates are not approved certificates, this is a finding.  ","fix":"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority.\n\nConfigure PostgreSQL to accept only DoD and DoD-approved PKI end-entity\ncertificates. Verify that xpack.ssl.certificate_authorities is pointing to the\ntrusted certificate authority from an approved service providoer.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"},"code":"control \"V-27172\" do\n  title \"Setup security settings to utilize organizational attained\ncertificates within the Elasticsearch cluster\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch utilizes organizational attained\ncertificates.\"\n  impact 0.5\n  tag \"nist\": [\"SC-17\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34471r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000205\"\n  tag \"cci\": \"CCI-001159\"\n  tag \"check\": \"Application must obtain public key certificates from an\napporved service provider.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to approved public key certificates.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt\\\" ]\n\nIf these certificates are not approved certificates, this is a finding.  \"\n  tag \"fix\": \"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority.\n\nConfigure PostgreSQL to accept only DoD and DoD-approved PKI end-entity\ncertificates. Verify that xpack.ssl.certificate_authorities is pointing to the\ntrusted certificate authority from an approved service providoer.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-27172.rb","line":1},"id":"V-27172","results":[{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil","run_time":0.000124,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil","run_time":9.0e-05,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil","run_time":0.000139,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/","run_time":0.043375,"start_time":"2017-09-19 23:27:22 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate","run_time":0.000239,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid","run_time":0.000136,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate","run_time":0.0001,"start_time":"2017-09-19 23:27:23 -0400"},{"status":"passed","code_desc":"x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid","run_time":0.000109,"start_time":"2017-09-19 23:27:23 -0400"}]},{"title":"Encrypt data at rest","desc":"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.","impact":0.5,"refs":[],"tags":{"nist":["SC-28 (1)","Rev_3"],"severity":"medium","rid":"SV-37459r1_rule","stig_id":"SRG-APP-000232","cci":"CCI-001200","check":"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.","fix":"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html"},"code":"control \"V-29188\" do\n  title \"Encrypt data at rest\"\n  desc  \"If necessary, encrypt data stored by Elasticsearch at rest through the\nuse of operating system controlled, and hardware accelerating file system\nencryption utilizing key management not governed by the data repository.\"\n  impact 0.5\n  tag \"nist\": [\"SC-28 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-37459r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000232\"\n  tag \"cci\": \"CCI-001200\"\n  tag \"check\": \"Determine if encryption must be used to protect data on the\nsystem. If encryption must be used and is not employed, this is a finding.\"\n  tag \"fix\": \"For automated/unattended installations, it is possible to use\nKickstart by adding the --encrypted and --passphrase= options to the definition\nof each partition to be encrypted. For example, the following line would\nencrypt the root partition:\npart / --fstype=ext4 --size=100 --onpart=hda1 --encrypted\n--passphrase=PASSPHRASE\nAny PASSPHRASE is stored in the Kickstart in plaintext, and the Kickstart must\nthen be protected accordingly. Omitting the --passphrase= option from the\npartition definition will cause the installer to pause and interactively ask\nfor the passphrase during installation.\n\nDetailed information on encrypting partitions using LUKS can be found on the\nRed Hat Documentation web site:\nhttps://docs.redhat.com/docs/en-US/Red_Hat_Enterprise_Linux/7/html/Security_Guide/sec-Encryption.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-29188.rb","line":1},"id":"V-29188"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (2)","Rev_4"],"severity":"medium","rid":"SV-40308r1_rule","stig_id":"SRG-APP-000234","cci":"CCI-001682","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-30574\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40308r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000234\"\n  tag \"cci\": \"CCI-001682\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-30574.rb","line":1},"id":"V-30574"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (4)","Rev_4"],"severity":"medium","rid":"SV-40309r1_rule","stig_id":"SRG-APP-000291","cci":"CCI-001683","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-30575\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40309r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000291\"\n  tag \"cci\": \"CCI-001683\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-30575.rb","line":1},"id":"V-30575"},{"title":"Separate the management of authentication policies from Elasticsearch","desc":"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.","impact":0.5,"refs":[],"tags":{"nist":["AC-2 (4)","Rev_4"],"severity":"medium","rid":"SV-40310r1_rule","stig_id":"SRG-APP-000292","cci":"CCI-001684","check":"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\n","fix":"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"},"code":"control \"V-30576\" do\n  title \"Separate the management of authentication policies from Elasticsearch\"\n  desc  \"Configure the centralized authentication service to enforce\norganization policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40310r1_rule\"\n  tag \"stig_id\": \"SRG-APP-000292\"\n  tag \"cci\": \"CCI-001684\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to organization\nsupported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\nend\n","source_location":{"ref":"../elasticsearch-inspec/controls/V-30576.rb","line":1},"id":"V-30576"}],"groups":[{"title":null,"controls":["V-26680"],"id":"controls/V-26680.rb"},{"title":null,"controls":["V-26681"],"id":"controls/V-26681.rb"},{"title":null,"controls":["V-26682"],"id":"controls/V-26682.rb"},{"title":null,"controls":["V-26684"],"id":"controls/V-26684.rb"},{"title":null,"controls":["V-26685"],"id":"controls/V-26685.rb"},{"title":null,"controls":["V-26687"],"id":"controls/V-26687.rb"},{"title":null,"controls":["V-26688"],"id":"controls/V-26688.rb"},{"title":null,"controls":["V-26699"],"id":"controls/V-26699.rb"},{"title":null,"controls":["V-26701"],"id":"controls/V-26701.rb"},{"title":null,"controls":["V-26705"],"id":"controls/V-26705.rb"},{"title":null,"controls":["V-26730"],"id":"controls/V-26730.rb"},{"title":null,"controls":["V-26737"],"id":"controls/V-26737.rb"},{"title":null,"controls":["V-26748"],"id":"controls/V-26748.rb"},{"title":null,"controls":["V-26775"],"id":"controls/V-26775.rb"},{"title":null,"controls":["V-26776"],"id":"controls/V-26776.rb"},{"title":null,"controls":["V-26777"],"id":"controls/V-26777.rb"},{"title":null,"controls":["V-26786"],"id":"controls/V-26786.rb"},{"title":null,"controls":["V-26790"],"id":"controls/V-26790.rb"},{"title":null,"controls":["V-26845"],"id":"controls/V-26845.rb"},{"title":null,"controls":["V-26847"],"id":"controls/V-26847.rb"},{"title":null,"controls":["V-26849"],"id":"controls/V-26849.rb"},{"title":null,"controls":["V-26851"],"id":"controls/V-26851.rb"},{"title":null,"controls":["V-26853"],"id":"controls/V-26853.rb"},{"title":null,"controls":["V-26855"],"id":"controls/V-26855.rb"},{"title":null,"controls":["V-26856"],"id":"controls/V-26856.rb"},{"title":null,"controls":["V-26858"],"id":"controls/V-26858.rb"},{"title":null,"controls":["V-26860"],"id":"controls/V-26860.rb"},{"title":null,"controls":["V-26864"],"id":"controls/V-26864.rb"},{"title":null,"controls":["V-26868"],"id":"controls/V-26868.rb"},{"title":null,"controls":["V-26881"],"id":"controls/V-26881.rb"},{"title":null,"controls":["V-26882"],"id":"controls/V-26882.rb"},{"title":null,"controls":["V-26883"],"id":"controls/V-26883.rb"},{"title":null,"controls":["V-26884"],"id":"controls/V-26884.rb"},{"title":null,"controls":["V-26886"],"id":"controls/V-26886.rb"},{"title":null,"controls":["V-26892"],"id":"controls/V-26892.rb"},{"title":null,"controls":["V-26894"],"id":"controls/V-26894.rb"},{"title":null,"controls":["V-26896"],"id":"controls/V-26896.rb"},{"title":null,"controls":["V-26900"],"id":"controls/V-26900.rb"},{"title":null,"controls":["V-26902"],"id":"controls/V-26902.rb"},{"title":null,"controls":["V-26903"],"id":"controls/V-26903.rb"},{"title":null,"controls":["V-26904"],"id":"controls/V-26904.rb"},{"title":null,"controls":["V-26907"],"id":"controls/V-26907.rb"},{"title":null,"controls":["V-26908"],"id":"controls/V-26908.rb"},{"title":null,"controls":["V-26910"],"id":"controls/V-26910.rb"},{"title":null,"controls":["V-26912"],"id":"controls/V-26912.rb"},{"title":null,"controls":["V-26913"],"id":"controls/V-26913.rb"},{"title":null,"controls":["V-26914"],"id":"controls/V-26914.rb"},{"title":null,"controls":["V-26915"],"id":"controls/V-26915.rb"},{"title":null,"controls":["V-26916"],"id":"controls/V-26916.rb"},{"title":null,"controls":["V-26918"],"id":"controls/V-26918.rb"},{"title":null,"controls":["V-26919"],"id":"controls/V-26919.rb"},{"title":null,"controls":["V-26920"],"id":"controls/V-26920.rb"},{"title":null,"controls":["V-26921"],"id":"controls/V-26921.rb"},{"title":null,"controls":["V-26922"],"id":"controls/V-26922.rb"},{"title":null,"controls":["V-26923"],"id":"controls/V-26923.rb"},{"title":null,"controls":["V-26924"],"id":"controls/V-26924.rb"},{"title":null,"controls":["V-26925"],"id":"controls/V-26925.rb"},{"title":null,"controls":["V-26926"],"id":"controls/V-26926.rb"},{"title":null,"controls":["V-26927"],"id":"controls/V-26927.rb"},{"title":null,"controls":["V-26930"],"id":"controls/V-26930.rb"},{"title":null,"controls":["V-26935"],"id":"controls/V-26935.rb"},{"title":null,"controls":["V-26937"],"id":"controls/V-26937.rb"},{"title":null,"controls":["V-26940"],"id":"controls/V-26940.rb"},{"title":null,"controls":["V-26947"],"id":"controls/V-26947.rb"},{"title":null,"controls":["V-26948"],"id":"controls/V-26948.rb"},{"title":null,"controls":["V-26953"],"id":"controls/V-26953.rb"},{"title":null,"controls":["V-26954"],"id":"controls/V-26954.rb"},{"title":null,"controls":["V-26972"],"id":"controls/V-26972.rb"},{"title":null,"controls":["V-27015"],"id":"controls/V-27015.rb"},{"title":null,"controls":["V-27024"],"id":"controls/V-27024.rb"},{"title":null,"controls":["V-27035"],"id":"controls/V-27035.rb"},{"title":null,"controls":["V-27059"],"id":"controls/V-27059.rb"},{"title":null,"controls":["V-27060"],"id":"controls/V-27060.rb"},{"title":null,"controls":["V-27061"],"id":"controls/V-27061.rb"},{"title":null,"controls":["V-27062"],"id":"controls/V-27062.rb"},{"title":null,"controls":["V-27063"],"id":"controls/V-27063.rb"},{"title":null,"controls":["V-27064"],"id":"controls/V-27064.rb"},{"title":null,"controls":["V-27092"],"id":"controls/V-27092.rb"},{"title":null,"controls":["V-27120"],"id":"controls/V-27120.rb"},{"title":null,"controls":["V-27130"],"id":"controls/V-27130.rb"},{"title":null,"controls":["V-27137"],"id":"controls/V-27137.rb"},{"title":null,"controls":["V-27140"],"id":"controls/V-27140.rb"},{"title":null,"controls":["V-27145"],"id":"controls/V-27145.rb"},{"title":null,"controls":["V-27146"],"id":"controls/V-27146.rb"},{"title":null,"controls":["V-27147"],"id":"controls/V-27147.rb"},{"title":null,"controls":["V-27148"],"id":"controls/V-27148.rb"},{"title":null,"controls":["V-27150"],"id":"controls/V-27150.rb"},{"title":null,"controls":["V-27153"],"id":"controls/V-27153.rb"},{"title":null,"controls":["V-27154"],"id":"controls/V-27154.rb"},{"title":null,"controls":["V-27155"],"id":"controls/V-27155.rb"},{"title":null,"controls":["V-27160"],"id":"controls/V-27160.rb"},{"title":null,"controls":["V-27163"],"id":"controls/V-27163.rb"},{"title":null,"controls":["V-27164"],"id":"controls/V-27164.rb"},{"title":null,"controls":["V-27165"],"id":"controls/V-27165.rb"},{"title":null,"controls":["V-27166"],"id":"controls/V-27166.rb"},{"title":null,"controls":["V-27168"],"id":"controls/V-27168.rb"},{"title":null,"controls":["V-27172"],"id":"controls/V-27172.rb"},{"title":null,"controls":["V-29188"],"id":"controls/V-29188.rb"},{"title":null,"controls":["V-30574"],"id":"controls/V-30574.rb"},{"title":null,"controls":["V-30575"],"id":"controls/V-30575.rb"},{"title":null,"controls":["V-30576"],"id":"controls/V-30576.rb"}],"attributes":[{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch"}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"es_superusers","options":{"description":"List of superusers","default":["elastic"]}},{"name":"es_owner","options":{"description":"Elasticsearch owner","default":"elasticsearch"}},{"name":"es_group","options":{"description":"Elasticsearch owner","default":"elasticsearch"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"managed_access_points","options":{"description":"List of managed access points","default":["10.0.2.15"]}},{"name":"es_admin","options":{"description":"Elasticsearch admin","default":"elastic"}},{"name":"es_pass","options":{"description":"Elasticsearch admin password","default":"changeme"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_denied","anonymous_access_denied","authentication_failed","connection_denied","tampered_request","run_as_denied","run_as_granted"]}},{"name":"es_included_logevents","options":{"description":"List of events to be logged","default":["access_granted"]}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elastic_ip","options":{"description":"IP address of the elasticsearch instance","default":"0.0.0.0"}},{"name":"elastic_port","options":{"description":"Port address of the elasticsearch instance","default":"9200"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"elasticsearch_conf","options":{"description":"Path to elasticsearch.yaml","default":"/etc/elasticsearch/elasticsearch.yml"}},{"name":"es_owner","options":{"description":"Elasticsearch owner","default":"elasticsearch"}},{"name":"es_group","options":{"description":"Elasticsearch owner","default":"elasticsearch"}}],"sha256":"0caeee8ad06554873d9f00ebac98a08eb7d9d0f31c7d31493d3bd09066389434"}],"platform":{"name":"centos","release":"7.2.1511"},"statistics":{"duration":2.638682}}